name: nova-blueprint-dev

services:
  nova-blueprint:
    build:
      context: .
      dockerfile: Dockerfile
      target: base
    image: nova-blueprint:dev
    container_name: nova-blueprint-dev
    restart: "no"
    working_dir: /app
    gpus: all
    init: true
    stop_grace_period: 24h
    environment:
      - PYTHONPATH=/app
      - HOST_MINER_RUNS=${PWD}/data/miner_runs
      - HOST_RESULTS=${PWD}/data/results
    volumes:
      - ./:/app:rw
      - ${PWD}/data/miner_runs:/data/miner_runs
      - ${PWD}/data/results:/data/results
      - ${BT_WALLETS_DIR:-$HOME/.bittensor/wallets}:/root/.bittensor/wallets:ro
      - /var/run/docker.sock:/var/run/docker.sock
    env_file:
      - .env
    entrypoint: ["python", "neurons/validator/scheduler.py"]
    command: ["--wallet.name", "${BT_WALLET_COLD}", "--wallet.hotkey", "${BT_WALLET_HOT}", "--logging.debug", "--test_mode"]
